Search.setIndex({"docnames": ["code/decoders", "code/encoders", "code/eval_gebid", "code/infer", "code/mmvae_base", "code/mmvae_models", "code/objectives", "code/trainer", "code/vae", "index", "tutorials/adddataset", "tutorials/addmodel"], "filenames": ["code/decoders.rst", "code/encoders.rst", "code/eval_gebid.rst", "code/infer.rst", "code/mmvae_base.rst", "code/mmvae_models.rst", "code/objectives.rst", "code/trainer.rst", "code/vae.rst", "index.rst", "tutorials/adddataset.rst", "tutorials/addmodel.rst"], "titles": ["Decoders", "Encoders", "Evaluate on GeBiD dataset", "Inference module", "Multimodal VAE Base Class", "Multimodal VAE models", "Objectives", "Trainer class", "VAE class", "Multimodal VAE Comparison Toolkit Documentation", "Add a new dataset", "Add a new model"], "terms": {"class": [0, 1, 5, 6, 9, 11], "multimodal_compar": [0, 1, 3, 4, 5, 6, 7, 8], "model": [0, 1, 3, 4, 6, 7, 8, 9], "dec_audio": 0, "latent_dim": [0, 1, 11], "data_dim": [0, 1, 11], "1": [0, 1, 5, 6, 8, 11], "forward": [0, 1, 5, 8, 11], "z": [0, 5, 11], "arg": [0, 1], "input": [0, 1, 5, 6, 11], "tensor": [0, 1, 7, 11], "shape": [0, 1, 11], "b": [0, 1], "t": [0, 1, 7], "c": [0, 1], "dec_cnn": 0, "defin": [0, 1, 5, 8, 11], "comput": [0, 1, 3, 5, 6, 8], "perform": [0, 1, 5, 8], "everi": [0, 1, 5, 8], "call": [0, 1, 5, 8, 9], "should": [0, 1, 5, 8, 11], "overridden": [0, 1, 5, 8], "all": [0, 1, 5, 7, 8, 11], "subclass": [0, 1, 5, 8], "although": [0, 1, 5, 8, 11], "recip": [0, 1, 5, 8], "pass": [0, 1, 5, 8, 11], "need": [0, 1, 5, 6, 8, 11], "within": [0, 1, 5, 8], "thi": [0, 1, 5, 6, 8, 9, 11], "function": [0, 1, 5, 8, 9, 11], "one": [0, 1, 5, 8], "modul": [0, 1, 5, 8, 9, 11], "instanc": [0, 1, 5, 8, 11], "afterward": [0, 1, 5, 8], "instead": [0, 1, 5, 8], "sinc": [0, 1, 5, 8], "former": [0, 1, 5, 8], "take": [0, 1, 5, 8], "care": [0, 1, 5, 8], "run": [0, 1, 5, 7, 8, 11], "regist": [0, 1, 5, 8], "hook": [0, 1, 5, 8], "while": [0, 1, 5, 8], "latter": [0, 1, 5, 8], "silent": [0, 1, 5, 8], "ignor": [0, 1, 5, 8], "them": [0, 1, 5, 8], "dec_fnn": 0, "dec_mnist": 0, "dec_mnistmo": 0, "num_hidden_lay": [0, 1], "mnist": [0, 1, 11], "imag": [0, 1, 11], "data": [0, 1, 3, 6, 7, 8, 11], "origin": [0, 1, 11], "implement": [0, 1, 9, 11], "http": [0, 1, 5, 6, 11], "github": [0, 1, 5, 6, 11], "com": [0, 1, 5, 6, 11], "iffsid": [0, 1, 5, 6], "mmvae": [0, 1, 4, 5, 6, 9, 11], "dec_mnist_dmva": [0, 11], "num_pixel": [0, 1, 11], "784": [0, 1, 11], "num_hidden": [0, 1, 11], "256": [0, 1, 11], "zprivate_dim": [0, 1, 11], "dec_svhn": 0, "dec_svhnmo": 0, "svhn": [0, 1, 11], "dec_svhn_dmva": 0, "4": [0, 1, 11], "dec_transform": 0, "ff_size": [0, 1], "1024": [0, 1], "num_lay": [0, 1], "num_head": [0, 1], "2": [0, 1, 11], "dropout": [0, 1], "0": [0, 1, 5, 11], "activ": [0, 1], "gelu": [0, 1], "batch": [0, 1, 6, 7, 8], "dec_transformerimg": 0, "dec_txttransform": 0, "dec_videogpt": 0, "n_res_lay": [0, 1], "upsampl": 0, "x": [0, 1, 5, 6, 8, 11], "decoder_conv2": 0, "densiti": [0, 1], "initial_s": [0, 1], "64": [0, 1], "channel": [0, 1], "3": [0, 11], "train": [0, 1, 7, 9, 11], "true": [0, 1], "enc_audio": 1, "enc_cnn": 1, "enc_conv2": 1, "normal": [1, 8, 11], "enc_fnn": 1, "enc_mnist": 1, "enc_mnistmo": 1, "enc_mnist_dmva": [1, 11], "enc_svhn": 1, "enc_svhnmo": 1, "enc_svhn_dmva": 1, "enc_transform": 1, "8": 1, "transform": [1, 11], "vae": [1, 6, 7, 11], "mathux": 1, "actor": 1, "enc_transformerimg": 1, "enc_txttransform": 1, "enc_videogpt": 1, "downsampl": 1, "eval": 3, "estimate_log_margin": 3, "devic": [3, 7, 11], "cuda": [3, 5, 7, 11], "an": [3, 6], "estim": [3, 6], "log": [3, 6, 11], "margin": 3, "likelihood": [3, 11], "test": [3, 7, 11], "mmvae_bas": [4, 11], "prior_dist": [4, 8], "encod": [4, 5, 9, 11], "decod": [4, 5, 9, 11], "data_path": [4, 5, 8, 11], "feature_dim": [4, 5, 8, 11], "mod_typ": [4, 5, 8, 11], "n_latent": [4, 5, 8, 11], "test_split": [4, 5, 8, 11], "batch_siz": [4, 5, 8, 11], "mmvae_model": [5, 11], "dmvae": [5, 6, 9, 11], "privat": [5, 11], "share": [5, 11], "disentangl": [5, 11], "learn": [5, 11], "latent": [5, 11], "represent": [5, 11], "seqam": [5, 6, 11], "lab": [5, 6, 11], "apply_po": [5, 11], "qz_xs_share": [5, 11], "induc": 5, "encab": 5, "xa": 5, "xb": 5, "via": 5, "poe": [5, 6, 11], "i": [5, 6, 9, 11], "q": 5, "zi": 5, "zt": 5, "xi": 5, "xt": 5, "qi": 5, "qt": 5, "where": 5, "propto": 5, "p": [5, 6], "k": [5, 6, 8, 11], "moe": [5, 6, 11], "variaion": 5, "autoencod": [5, 9], "mixtur": 5, "expert": 5, "mopo": [5, 9, 11], "gener": [5, 6, 9], "elbo": [5, 6, 11], "thomassutt": 5, "product": 5, "mhw32": [5, 6], "public": [5, 6], "prior_expert": 5, "size": [5, 11], "use_cuda": 5, "fals": 5, "univers": 5, "prior": 5, "here": [5, 11], "we": [5, 9, 11], "us": [5, 6, 9, 11], "spheric": 5, "gaussian": 5, "n": [5, 11], "param": [5, 6, 8, 11], "integ": 5, "dimension": [5, 11], "boolean": 5, "default": [5, 9], "cast": 5, "variabl": 5, "calc_kld": 6, "latent_dist": 6, "calcul": [6, 11], "th": 6, "kl": [6, 7, 11], "diverg": [6, 7], "between": 6, "two": [6, 11], "distribut": [6, 8, 11], "compute_microbatch_split": 6, "check": 6, "broken": 6, "down": 6, "further": 6, "fit": 6, "memori": 6, "dreg": 6, "ltype": [6, 11], "lprob": [6, 11], "p_": 6, "heta": 6, "fulli": 6, "vectoris": 6, "sourc": [6, 11], "e_": 6, "iwa": 6, "beta": 6, "20": [6, 11], "import": [6, 11], "weight": 6, "od": 6, "multimod": [6, 7, 11], "type": [6, 7, 11], "list": [6, 7, 8, 11], "str": 6, "reconstructin": 6, "loss": [6, 7, 11], "term": [6, 11], "bce": 6, "l1": 6, "mse": 6, "categori": 6, "float": [6, 11], "paramet": [6, 7, 11], "todo": 6, "int": [6, 7], "sampl": [6, 7, 9, 11], "return": [6, 7, 8, 11], "torch": [6, 7, 8, 11], "multimodal_dreg_looser_mo": 6, "30": 6, "multi": 6, "modal": [6, 11], "version": 6, "looser": 6, "bound": 6, "averag": 6, "over": [6, 7], "outsid": 6, "multimodal_elbo_dmva": [6, 11], "multimodal_elbo_mo": 6, "multimodal_elbo_mopo": 6, "5": [6, 9], "arxiv": 6, "org": 6, "pdf": 6, "2105": 6, "02470": 6, "multimodal_elbo_po": 6, "subsampl": 6, "approach": 6, "rtype": [6, 7], "multimodal_iwae_mo": 6, "main": [7, 11], "cfg": [7, 11], "common": [7, 11], "architectur": 7, "configur": [7, 11], "dict": 7, "pars": 7, "yml": [7, 11], "config": [7, 11], "object": [7, 9, 11], "cpu": 7, "get_torch_mean": 7, "get": 7, "mean": [7, 11], "float32": [7, 11], "iterate_epoch": 7, "The": [7, 9, 11], "iter": 7, "prepare_data": 7, "unpack": 7, "sent": 7, "come": 7, "from": [7, 11], "dataload": 7, "prepar": 7, "length": 7, "prepare_testset": 7, "num_sampl": 7, "none": [7, 11], "retriev": 7, "testload": 7, "visual": 7, "method": [7, 11], "how": [7, 11], "mani": 7, "d_len": 7, "setup": 7, "initi": 7, "find": [7, 9, 11], "select": [7, 11], "epoch": [7, 11], "loader": 7, "current": [7, 9, 11], "visualize_lat": 7, "analysi": 7, "save": 7, "sne": 7, "parse_arg": 7, "load": [7, 11], "specifi": [7, 11], "argument": 7, "ani": [7, 11], "addit": 7, "overrid": 7, "valu": 7, "enc": [8, 11], "dec": [8, 11], "likelihood_dist": 8, "post_dist": 8, "seq_collate_fn": 8, "collat": 8, "sequenti": [8, 11], "mask": 8, "purpos": 9, "offer": 9, "systemat": 9, "unifi": 9, "wai": 9, "evalu": 9, "compar": [9, 11], "state": 9, "art": 9, "variat": 9, "can": [9, 11], "arbitrari": 9, "dataset": [9, 11], "both": 9, "uni": 9, "set": 9, "By": 9, "provid": 9, "mvae": 9, "paper": 9, "anyon": 9, "free": 9, "contribut": 9, "own": [9, 11], "also": [9, 11], "custom": [9, 11], "synthet": 9, "bimod": 9, "gebid": 9, "design": 9, "specif": [9, 11], "joint": 9, "cross": [9, 11], "capabl": 9, "you": [9, 11], "read": 9, "about": 9, "util": 9, "propos": 9, "link": 9, "ad": 9, "soon": 9, "level": 9, "difficulti": 9, "base": 9, "number": [9, 11], "attribut": 9, "minim": [9, 11], "scenario": [9, 11], "each": [9, 11], "moreov": 9, "its": 9, "rigid": 9, "structur": [9, 11], "enabl": 9, "automat": 9, "qualit": 9, "For": 9, "more": 9, "info": 9, "see": [9, 11], "below": [9, 11], "page": 9, "work": 9, "progress": 9, "sub": 9, "add": 9, "new": 9, "trainer": 9, "infer": 9, "encourag": 11, "author": 11, "our": 11, "toolkit": 11, "describ": 11, "do": 11, "written": 11, "pytorch": 11, "expect": 11, "framework": 11, "well": 11, "possibl": 11, "unimod": 11, "which": 11, "dedic": 11, "network": 11, "cours": 11, "other": 11, "support": 11, "ar": 11, "show": 11, "step": 11, "tutori": 11, "repositori": 11, "first": 11, "start": 11, "py": 11, "name": 11, "inherit": 11, "handl": 11, "some": 11, "visualis": 11, "etc": 11, "init": 11, "file": 11, "have": 11, "fix": 11, "self": 11, "modelnam": 11, "def": 11, "__init__": 11, "super": 11, "dist": 11, "qz_x": 11, "now": 11, "necessari": 11, "integr": 11, "concaten": 11, "miss": 11, "replac": 11, "case": 11, "onli": 11, "want": 11, "your": 11, "later": 11, "px_z": 11, "_": 11, "rang": 11, "len": 11, "qz_xs_privat": 11, "initialis": 11, "matrix": 11, "m": 11, "enumer": 11, "mod_mu": 11, "mod_std": 11, "isinst": 11, "els": 11, "append": 11, "mu_joint": 11, "std_joint": 11, "joint_d": 11, "all_shar": 11, "zss": 11, "d": 11, "e": 11, "zs_share": 11, "rsampl": 11, "zs_privat": 11, "cat": 11, "dec_nam": 11, "lower": 11, "tupl": 11, "posterior": 11, "parametr": 11, "output": 11, "vector": 11, "If": 11, "next": 11, "locat": 11, "directori": 11, "__all__": 11, "re": 11, "exist": 11, "ones": 11, "nn": 11, "net_typ": 11, "fnn": 11, "temp": 11, "66": 11, "digit_temp": 11, "zshared_dim": 11, "enc_hidden": 11, "linear": 11, "relu": 11, "fc": 11, "hidden": 11, "reshap": 11, "stat": 11, "mupriv": 11, "logvarpriv": 11, "stdprivat": 11, "sqrt": 11, "exp": 11, "constant": 11, "ep": 11, "mushar": 11, "logvarshar": 11, "stdshare": 11, "again": 11, "intial": 11, "like": 11, "space": 11, "after": 11, "underscor": 11, "mnist_dmva": 11, "would": 11, "standard": 11, "deviat": 11, "howev": 11, "std": 11, "thu": 11, "adjust": 11, "style_mean": 11, "style_std": 11, "num_digit": 11, "dec_hidden": 11, "dec_imag": 11, "sigmoid": 11, "75": 11, "process": 11, "similar": 11, "reconstruct": 11, "could": 11, "differ": 11, "perhap": 11, "last": 11, "thing": 11, "form": 11, "multimodal_": 11, "objectivenam": 11, "so": 11, "know": 11, "when": 11, "obj": 11, "kei": 11, "mix": 11, "recon": 11, "ind_loss": 11, "j": 11, "loss_fn": 11, "llik_scal": 11, "idx": 11, "log_pz": 11, "log_joint": 11, "log_q_zcx": 11, "log_qz": 11, "log_prod_qzi": 11, "log_batch_margin": 11, "get_all_pair": 11, "rec": 11, "zip": 11, "l": 11, "sum": 11, "stack": 11, "receiv": 11, "inpt": 11, "reconstrct": 11, "final": 11, "option": 11, "kld": 11, "abl": 11, "creat": 11, "follow": 11, "previous": 11, "experi": 11, "cd": 11, "python": 11, "32": 11, "700": 11, "exp_nam": 11, "dmvae_exp": 11, "label": 11, "mnist_svhn": 11, "pkl": 11, "lr": 11, "1e": 11, "10": 11, "optim": 11, "adam": 11, "pre_train": 11, "null": 11, "seed": 11, "viz_freq": 11, "modality_1": 11, "28": 11, "path": 11, "modality_2": 11, "svhn_dmvae": 11}, "objects": {"multimodal_compare.eval": [[2, 0, 0, "-", "eval_gebid"], [3, 0, 0, "-", "infer"]], "multimodal_compare.eval.infer": [[3, 1, 1, "", "estimate_log_marginal"]], "multimodal_compare": [[7, 0, 0, "-", "main"]], "multimodal_compare.main": [[7, 2, 1, "", "Trainer"], [7, 1, 1, "", "parse_args"]], "multimodal_compare.main.Trainer": [[7, 3, 1, "", "get_torch_mean"], [7, 3, 1, "", "iterate_epochs"], [7, 3, 1, "", "prepare_data"], [7, 3, 1, "", "prepare_testset"], [7, 3, 1, "", "setup"], [7, 3, 1, "", "test"], [7, 3, 1, "", "train"], [7, 3, 1, "", "visualize_latents"]], "multimodal_compare.models": [[0, 0, 0, "-", "decoders"], [1, 0, 0, "-", "encoders"], [4, 0, 0, "-", "mmvae_base"], [5, 0, 0, "-", "mmvae_models"], [6, 0, 0, "-", "objectives"], [8, 0, 0, "-", "vae"]], "multimodal_compare.models.decoders": [[0, 2, 1, "", "Dec_Audio"], [0, 2, 1, "", "Dec_CNN"], [0, 2, 1, "", "Dec_FNN"], [0, 2, 1, "", "Dec_MNIST"], [0, 2, 1, "", "Dec_MNISTMoE"], [0, 2, 1, "", "Dec_MNIST_DMVAE"], [0, 2, 1, "", "Dec_SVHN"], [0, 2, 1, "", "Dec_SVHNMoE"], [0, 2, 1, "", "Dec_SVHN_DMVAE"], [0, 2, 1, "", "Dec_Transformer"], [0, 2, 1, "", "Dec_TransformerIMG"], [0, 2, 1, "", "Dec_TxtTransformer"], [0, 2, 1, "", "Dec_VideoGPT"], [0, 2, 1, "", "Decoder_Conv2"]], "multimodal_compare.models.decoders.Dec_Audio": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_CNN": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_FNN": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_MNIST": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_MNISTMoE": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_MNIST_DMVAE": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_SVHN": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_SVHNMoE": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_SVHN_DMVAE": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_Transformer": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_TransformerIMG": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_TxtTransformer": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Dec_VideoGPT": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.decoders.Decoder_Conv2": [[0, 3, 1, "", "forward"]], "multimodal_compare.models.encoders": [[1, 2, 1, "", "Enc_Audio"], [1, 2, 1, "", "Enc_CNN"], [1, 2, 1, "", "Enc_Conv2"], [1, 2, 1, "", "Enc_FNN"], [1, 2, 1, "", "Enc_MNIST"], [1, 2, 1, "", "Enc_MNISTMoE"], [1, 2, 1, "", "Enc_MNIST_DMVAE"], [1, 2, 1, "", "Enc_SVHN"], [1, 2, 1, "", "Enc_SVHNMoE"], [1, 2, 1, "", "Enc_SVHN_DMVAE"], [1, 2, 1, "", "Enc_Transformer"], [1, 2, 1, "", "Enc_TransformerIMG"], [1, 2, 1, "", "Enc_TxtTransformer"], [1, 2, 1, "", "Enc_VideoGPT"]], "multimodal_compare.models.encoders.Enc_Audio": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_CNN": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_Conv2": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_FNN": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_MNIST": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_MNISTMoE": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_MNIST_DMVAE": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_SVHN": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_SVHNMoE": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_SVHN_DMVAE": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_Transformer": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_TransformerIMG": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_TxtTransformer": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.encoders.Enc_VideoGPT": [[1, 3, 1, "", "forward"]], "multimodal_compare.models.mmvae_base": [[4, 2, 1, "", "MMVAE"]], "multimodal_compare.models.mmvae_models": [[5, 2, 1, "", "DMVAE"], [5, 2, 1, "", "MOE"], [5, 2, 1, "", "MoPOE"], [5, 2, 1, "", "POE"]], "multimodal_compare.models.mmvae_models.DMVAE": [[5, 3, 1, "", "apply_poe"], [5, 3, 1, "", "forward"]], "multimodal_compare.models.mmvae_models.MOE": [[5, 3, 1, "", "forward"]], "multimodal_compare.models.mmvae_models.POE": [[5, 3, 1, "", "forward"], [5, 3, 1, "", "prior_expert"]], "multimodal_compare.models.objectives": [[6, 1, 1, "", "calc_klds"], [6, 1, 1, "", "compute_microbatch_split"], [6, 1, 1, "", "dreg"], [6, 1, 1, "", "elbo"], [6, 1, 1, "", "iwae"], [6, 1, 1, "", "multimodal_dreg_looser_moe"], [6, 1, 1, "", "multimodal_elbo_dmvae"], [6, 1, 1, "", "multimodal_elbo_moe"], [6, 1, 1, "", "multimodal_elbo_mopoe"], [6, 1, 1, "", "multimodal_elbo_poe"], [6, 1, 1, "", "multimodal_iwae_moe"]], "multimodal_compare.models.vae": [[8, 2, 1, "", "VAE"]], "multimodal_compare.models.vae.VAE": [[8, 3, 1, "", "forward"], [8, 3, 1, "", "seq_collate_fn"]]}, "objtypes": {"0": "py:module", "1": "py:function", "2": "py:class", "3": "py:method"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "function", "Python function"], "2": ["py", "class", "Python class"], "3": ["py", "method", "Python method"]}, "titleterms": {"decod": 0, "encod": 1, "evalu": 2, "gebid": 2, "dataset": [2, 10], "infer": 3, "modul": 3, "multimod": [4, 5, 9], "vae": [4, 5, 8, 9], "base": 4, "class": [4, 7, 8], "model": [5, 11], "object": 6, "trainer": 7, "comparison": 9, "toolkit": 9, "document": 9, "tutori": 9, "code": 9, "add": [10, 11], "new": [10, 11], "gener": 11, "requir": 11, "ad": 11}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})